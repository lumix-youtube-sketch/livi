<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>livi</title>
<style>
/* --- BASE STYLES --- */
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:linear-gradient(135deg,#1a1a1a 0%,#0a0a0a 100%);color:white;max-width:428px;margin:0 auto;overflow-x:hidden;-webkit-tap-highlight-color:transparent;padding-bottom:90px;min-height:100vh}

/* --- ANIMATIONS --- */
@keyframes fadeIn{from{opacity:0}to{opacity:1}}
@keyframes slideUp{from{transform:translateY(20px);opacity:0}to{transform:translateY(0);opacity:1}}
@keyframes gentleFloat{0%,100%{transform:translateY(0px) rotate(0deg)}50%{transform:translateY(-8px) rotate(2deg)}}
@keyframes blink{0%,90%,100%{opacity:1}95%{opacity:.3}}
@keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}

/* --- UTILITIES --- */
.fade-in{animation:fadeIn .3s ease-out}
.slide-up{animation:slideUp .3s ease-out}
.pulse{animation:pulse 2s infinite}
.hidden{display:none!important}

/* --- LOADING SCREEN --- */
.loading-screen{position:fixed;inset:0;background:linear-gradient(135deg,#1a1a1a 0%,#0f0f0f 100%);display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:9999;transition:opacity .5s}
.loading-screen.fade-out{opacity:0;pointer-events:none}
.loading-logo{font-size:64px;font-weight:bold;background:linear-gradient(135deg,#8B9A9C 0%,#9CB3B5 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent}

/* --- HEADER --- */
.header{padding:20px;display:flex;align-items:center;justify-content:space-between;background:linear-gradient(135deg,rgba(15,15,15,.95) 0%,rgba(10,10,10,.95) 100%);backdrop-filter:blur(20px);border-bottom:1px solid #2a2a2a;position:sticky;top:0;z-index:50}
.header-title{font-size:28px;font-weight:700;background:linear-gradient(135deg,#8B9A9C 0%,#9CB3B5 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.header-stats{display:flex;gap:12px}
.stat-badge{display:flex;align-items:center;gap:8px;padding:8px 14px;border-radius:16px;font-weight:bold;font-size:16px;border:none;background:rgba(255,255,255,0.05);color:white}

/* --- NAVIGATION --- */
.bottom-nav{position:fixed;bottom:0;left:0;right:0;max-width:428px;margin:0 auto;background:rgba(15,15,15,.98);backdrop-filter:blur(20px);border-top:1px solid #2a2a2a;display:flex;justify-content:space-around;padding:12px 0 calc(12px + env(safe-area-inset-bottom));z-index:100}
.nav-item{flex:1;display:flex;flex-direction:column;align-items:center;gap:4px;padding:4px;cursor:pointer;background:none;border:none;color:#666;position:relative}
.nav-item.active{color:#8B9A9C}
.nav-item.active::before{content:'';position:absolute;top:-13px;width:30px;height:3px;background:#8B9A9C;border-radius:0 0 4px 4px}

/* --- CONTENT --- */
.content{padding:20px}
.section{background:linear-gradient(135deg,rgba(25,25,25,.6) 0%,rgba(10,10,10,.6) 100%);border:1px solid #2a2a2a;border-radius:20px;padding:20px;margin-bottom:20px;backdrop-filter:blur(10px)}
.grid-2{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin-bottom:20px}

/* --- LIVI CHARACTER --- */
.livi-character{display:flex;flex-direction:column;align-items:center;padding:20px 0}
.livi-circle{border-radius:50%;display:flex;align-items:center;justify-content:center;position:relative;animation:gentleFloat 4s ease-in-out infinite;box-shadow:0 0 30px rgba(139,154,156,.1)}
.livi-antenna{position:absolute;width:4px;height:30px;background:#8B9A9C;border-radius:2px}
.livi-antenna::after{content:'';position:absolute;top:-8px;left:50%;transform:translateX(-50%);width:10px;height:10px;background:#8B9A9C;border-radius:50%}
.livi-antenna.left{top:-20px;left:30px;transform:rotate(-15deg)}
.livi-antenna.right{top:-20px;right:30px;transform:rotate(15deg)}
.livi-face{position:absolute;width:100%;height:100%;display:flex;align-items:center;justify-content:center}
.livi-eyes{position:absolute;top:40%;width:50%;display:flex;justify-content:space-between}
.livi-eye{width:10px;height:10px;background:white;border-radius:50%;animation:blink 5s infinite}
.livi-mouth{position:absolute;bottom:35%;width:20px;height:10px;border-bottom:3px solid white;border-radius:0 0 10px 10px}

/* --- CARDS & BUTTONS --- */
.stat-card{background:rgba(255,255,255,0.03);border:1px solid #2a2a2a;border-radius:20px;padding:16px;text-align:center}
.stat-value{font-size:24px;font-weight:bold;margin:8px 0;background:linear-gradient(135deg,#8B9A9C,#9CB3B5);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.stat-label{font-size:12px;color:#888}

.task-item{display:flex;align-items:center;gap:12px;padding:16px;background:rgba(255,255,255,0.03);border:1px solid #2a2a2a;border-radius:16px;margin-bottom:10px;transition:all .2s}
.task-item.completed{opacity:0.6}
.task-item.completed .task-title{text-decoration:line-through;color:#666}
.checkbox{width:24px;height:24px;border:2px solid #8B9A9C;border-radius:8px;display:flex;align-items:center;justify-content:center;cursor:pointer}
.checkbox.checked{background:#8B9A9C}

.shop-item{background:rgba(255,255,255,0.03);border:1px solid #2a2a2a;border-radius:16px;padding:16px;display:flex;flex-direction:column;align-items:center;text-align:center;position:relative}
.shop-icon{font-size:32px;margin-bottom:8px}
.shop-price{font-weight:bold;color:#D4AF7A;margin-top:8px;font-size:14px}
.shop-btn{margin-top:12px;width:100%;padding:8px;border-radius:10px;border:none;font-weight:bold;cursor:pointer;font-size:12px}
.shop-btn.buy{background:#8B9A9C;color:white}
.shop-btn.owned{background:#2a2a2a;color:#666;cursor:default}

.btn{width:100%;padding:14px;border-radius:16px;font-weight:bold;font-size:16px;border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:8px;transition:all .2s}
.btn-primary{background:linear-gradient(135deg,#8B9A9C 0%,#9CB3B5 100%);color:white;box-shadow:0 4px 12px rgba(139,154,156,.3)}
.btn-secondary{background:transparent;border:1px solid #2a2a2a;color:#8B9A9C}

.add-btn{position:fixed;bottom:90px;right:20px;width:56px;height:56px;border-radius:50%;background:#8B9A9C;color:white;display:flex;align-items:center;justify-content:center;font-size:32px;box-shadow:0 4px 20px rgba(139,154,156,0.4);border:none;z-index:90}

svg{width:24px;height:24px;fill:none;stroke:currentColor;stroke-width:2;stroke-linecap:round;stroke-linejoin:round}
</style>
</head>
<body>

<div class="loading-screen" id="loadingScreen">
    <div class="loading-logo">livi</div>
</div>

<div id="app"></div>

<script>
// --- CONFIG & STATE ---
const colors = { primary: '#8B9A9C', accent: '#9CB3B5', warning: '#D4AF7A', bg: '#1a1a1a' };

// –ù–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å –¥–∞–Ω–Ω—ã–º–∏
let state = {
    activeTab: 'home',
    streak: 3,
    totalPoints: 120,
    weeklyStats: [30, 45, 60, 20, 80, 50, 40], // –ü–Ω-–í—Å
    tasks: [
        { id: 1, title: '–£—Ç—Ä–µ–Ω–Ω—è—è –∑–∞—Ä—è–¥–∫–∞', completed: true, type: 'habit', points: 10 },
        { id: 2, title: '–ü—Ä–æ—á–∏—Ç–∞—Ç—å 20 —Å—Ç—Ä–∞–Ω–∏—Ü', completed: false, type: 'task', points: 20 },
        { id: 3, title: '–ú–µ–¥–∏—Ç–∞—Ü–∏—è 10 –º–∏–Ω', completed: false, type: 'habit', points: 15 }
    ],
    shopItems: [
        { id: 1, name: '–ó–æ–ª–æ—Ç—ã–µ –Ω–∞—É—à–Ω–∏–∫–∏', icon: 'üéß', price: 200, owned: false },
        { id: 2, name: '–û—á–∫–∏ —Å—Ç–∏–ª—è', icon: 'üï∂Ô∏è', price: 100, owned: true },
        { id: 3, name: '–ö–µ–ø–∫–∞ Livi', icon: 'üß¢', price: 350, owned: false },
        { id: 4, name: '–ö–æ—Ñ–µ –±—É—Å—Ç', icon: '‚òï', price: 50, owned: false }
    ],
    dailyChallenge: {
        date: new Date().toDateString(),
        title: '–í—ã–ø–∏—Ç—å 2–ª –≤–æ–¥—ã',
        target: 8,
        current: 3,
        completed: false,
        reward: 50
    }
};

// --- ICONS ---
const icons = {
    home: '<path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/>',
    target: '<circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/>',
    check: '<polyline points="9 11 12 14 22 4"/><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/>',
    shop: '<path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"/><line x1="3" y1="6" x2="21" y2="6"/>',
    chart: '<line x1="12" y1="20" x2="12" y2="10"/><line x1="18" y1="20" x2="18" y2="4"/><line x1="6" y1="20" x2="6" y2="16"/>',
    flame: '<path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"/>',
    star: '<polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>',
    trash: '<polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>'
};

function getIcon(name, color = 'currentColor') {
    return `<svg style="color:${color}">${icons[name] || ''}</svg>`;
}

// --- ACTIONS ---
const actions = {
    toggleTask: (id) => {
        const task = state.tasks.find(t => t.id === id);
        if (task) {
            task.completed = !task.completed;
            if(task.completed) {
                state.totalPoints += task.points;
                // Simple animation trigger for points could go here
            } else {
                state.totalPoints -= task.points;
            }
            render();
        }
    },
    addTask: () => {
        const title = prompt("–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏:");
        if (title) {
            state.tasks.push({
                id: Date.now(),
                title,
                completed: false,
                type: 'task',
                points: 15
            });
            render();
        }
    },
    deleteTask: (id) => {
        if(confirm("–£–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞—á—É?")) {
            state.tasks = state.tasks.filter(t => t.id !== id);
            render();
        }
    },
    buyItem: (id) => {
        const item = state.shopItems.find(i => i.id === id);
        if (item && !item.owned) {
            if (state.totalPoints >= item.price) {
                state.totalPoints -= item.price;
                item.owned = true;
                alert(`–í—ã –∫—É–ø–∏–ª–∏ ${item.name}!`);
                render();
            } else {
                alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –æ—á–∫–æ–≤!");
            }
        }
    },
    completeChallenge: () => {
        if(!state.dailyChallenge.completed) {
            state.dailyChallenge.completed = true;
            state.totalPoints += state.dailyChallenge.reward;
            render();
        }
    }
};

// --- RENDER FUNCTIONS ---

function renderHeader() {
    return `
    <div class="header">
        <div class="header-title">livi</div>
        <div class="header-stats">
            <div class="stat-badge" style="color:#D4AF7A">
                ${getIcon('flame', '#D4AF7A')} ${state.streak}
            </div>
            <div class="stat-badge" style="color:#8B9A9C">
                ${getIcon('star', '#8B9A9C')} ${state.totalPoints}
            </div>
        </div>
    </div>`;
}

function renderLivi() {
    return `
    <div class="livi-character fade-in">
        <div class="livi-circle" style="width:120px;height:120px;background:rgba(139,154,156,0.1);border:3px solid ${colors.primary}">
            <div class="livi-antenna left"></div>
            <div class="livi-antenna right"></div>
            <div class="livi-face">
                <div class="livi-eyes">
                    <div class="livi-eye"></div>
                    <div class="livi-eye"></div>
                </div>
                <div class="livi-mouth"></div>
            </div>
        </div>
        <div style="margin-top:16px;font-weight:bold;color:${colors.primary}">–ü—Ä–∏–≤–µ—Ç, –ß–µ–º–ø–∏–æ–Ω!</div>
    </div>`;
}

function renderHome() {
    const tasksTotal = state.tasks.length;
    const tasksDone = state.tasks.filter(t => t.completed).length;
    
    return `
    <div class="slide-up">
        ${renderLivi()}
        <div class="section">
            <h3 style="margin-bottom:12px;font-size:18px">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–Ω—è</h3>
            <div class="grid-2" style="margin-bottom:0">
                <div class="stat-card">
                    ${getIcon('check', colors.primary)}
                    <div class="stat-value">${tasksDone}/${tasksTotal}</div>
                    <div class="stat-label">–ó–∞–¥–∞—á–∏</div>
                </div>
                <div class="stat-card">
                    ${getIcon('flame', colors.warning)}
                    <div class="stat-value">${state.streak}</div>
                    <div class="stat-label">–î–Ω–µ–π –ø–æ–¥—Ä—è–¥</div>
                </div>
            </div>
        </div>
        <div class="section" onclick="state.activeTab='challenges';render()">
            <div style="display:flex;justify-content:space-between;align-items:center">
                <div>
                    <div style="font-weight:bold;margin-bottom:4px">–ß–µ–ª–ª–µ–Ω–¥–∂ –¥–Ω—è</div>
                    <div style="font-size:12px;color:#999">${state.dailyChallenge.title}</div>
                </div>
                <div class="stat-badge" style="background:#D4AF7A;color:#1a1a1a;font-size:12px">
                    +${state.dailyChallenge.reward}
                </div>
            </div>
        </div>
    </div>`;
}

function renderTasksPage() {
    const tasksList = state.tasks.map(task => `
        <div class="task-item ${task.completed ? 'completed' : ''}">
            <div class="checkbox ${task.completed ? 'checked' : ''}" onclick="actions.toggleTask(${task.id})">
                ${task.completed ? '<svg viewBox="0 0 24 24" width="16" height="16" stroke="white" stroke-width="3" fill="none"><polyline points="20 6 9 17 4 12"/></svg>' : ''}
            </div>
            <div style="flex:1">
                <div class="task-title" style="font-weight:500">${task.title}</div>
                <div style="font-size:11px;color:#666;margin-top:2px">${task.type === 'habit' ? '–ü—Ä–∏–≤—ã—á–∫–∞' : '–ó–∞–¥–∞—á–∞'} ‚Ä¢ ${task.points} –æ—á–∫–æ–≤</div>
            </div>
            <button onclick="actions.deleteTask(${task.id})" style="background:none;border:none;color:#666;padding:4px">
                ${getIcon('trash')}
            </button>
        </div>
    `).join('');

    return `
    <div class="slide-up">
        <h2 style="margin-bottom:20px;font-size:24px;font-weight:bold">–¢–≤–æ–∏ –∑–∞–¥–∞—á–∏</h2>
        ${tasksList.length ? tasksList : '<div style="text-align:center;color:#666;padding:40px">–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–¥–∞—á</div>'}
        <button class="add-btn" onclick="actions.addTask()">+</button>
    </div>`;
}

function renderShop() {
    const items = state.shopItems.map(item => `
        <div class="shop-item">
            <div class="shop-icon">${item.icon}</div>
            <div style="font-weight:bold;font-size:14px">${item.name}</div>
            <div class="shop-price">${item.price} pts</div>
            <button class="shop-btn ${item.owned ? 'owned' : 'buy'}" 
                onclick="actions.buyItem(${item.id})">
                ${item.owned ? '–ö—É–ø–ª–µ–Ω–æ' : '–ö—É–ø–∏—Ç—å'}
            </button>
        </div>
    `).join('');

    return `
    <div class="slide-up">
        <div style="text-align:center;margin-bottom:20px">
            <div style="color:#888;font-size:14px">–¢–≤–æ–π –±–∞–ª–∞–Ω—Å</div>
            <div style="font-size:32px;font-weight:bold;color:${colors.warning}">${state.totalPoints} <span style="font-size:16px">pts</span></div>
        </div>
        <h3 style="margin-bottom:16px;font-weight:bold">–ê–∫—Å–µ—Å—Å—É–∞—Ä—ã</h3>
        <div class="grid-2">
            ${items}
        </div>
    </div>`;
}

function renderChallenges() {
    const ch = state.dailyChallenge;
    return `
    <div class="slide-up">
        <div class="section" style="text-align:center;padding:40px 20px;border-color:${colors.warning}">
            <div style="font-size:48px;margin-bottom:16px">üéØ</div>
            <h2 style="margin-bottom:8px;font-size:24px;font-weight:bold">${ch.title}</h2>
            <p style="color:#888;margin-bottom:24px">–í—ã–ø–æ–ª–Ω–∏ —ç—Ç–æ –∑–∞–¥–∞–Ω–∏–µ –¥–æ –∫–æ–Ω—Ü–∞ –¥–Ω—è</p>
            
            <div style="background:rgba(255,255,255,0.05);border-radius:12px;padding:16px;margin-bottom:24px">
                <div style="display:flex;justify-content:space-between;margin-bottom:8px;font-size:14px">
                    <span>–ü—Ä–æ–≥—Ä–µ—Å—Å</span>
                    <span>${ch.completed ? ch.target : ch.current} / ${ch.target}</span>
                </div>
                <div style="height:6px;background:#333;border-radius:3px;overflow:hidden">
                    <div style="height:100%;width:${ch.completed ? 100 : (ch.current/ch.target)*100}%;background:${colors.warning};transition:width .5s"></div>
                </div>
            </div>

            ${ch.completed 
                ? `<div class="btn" style="background:${colors.accent};color:#1a1a1a">–ó–∞–≤–µ—Ä—à–µ–Ω–æ! üéâ</div>`
                : `<button class="btn btn-primary" onclick="actions.completeChallenge()">–ó–∞–≤–µ—Ä—à–∏—Ç—å (+${ch.reward})</button>`
            }
        </div>
    </div>`;
}

function renderAnalysis() {
    // Simple bar chart visualization
    const maxVal = Math.max(...state.weeklyStats);
    const bars = state.weeklyStats.map((val, idx) => {
        const height = (val / maxVal) * 100;
        const days = ['–ü–Ω','–í—Ç','–°—Ä','–ß—Ç','–ü—Ç','–°–±','–í—Å'];
        return `
            <div style="display:flex;flex-direction:column;align-items:center;flex:1;gap:8px">
                <div style="width:100%;height:100px;display:flex;align-items:flex-end;justify-content:center">
                    <div style="width:8px;height:${height}%;background:linear-gradient(to top, ${colors.primary}, ${colors.accent});border-radius:4px"></div>
                </div>
                <div style="font-size:10px;color:#666">${days[idx]}</div>
            </div>
        `;
    }).join('');

    return `
    <div class="slide-up">
        <h2 style="margin-bottom:20px;font-weight:bold">–¢–≤–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å</h2>
        <div class="section">
            <div style="margin-bottom:20px;color:#888;font-size:14px">–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∑–∞ –Ω–µ–¥–µ–ª—é</div>
            <div style="display:flex;justify-content:space-between;gap:4px">
                ${bars}
            </div>
        </div>
        <div class="section">
            <div style="display:flex;align-items:center;gap:12px;margin-bottom:12px">
                <div style="padding:10px;background:rgba(212,175,122,0.1);border-radius:10px;color:${colors.warning}">
                    ${getIcon('flame')}
                </div>
                <div>
                    <div style="font-weight:bold">–û—Ç–ª–∏—á–Ω—ã–π —Ç–µ–º–ø!</div>
                    <div style="font-size:12px;color:#666">–¢—ã –≤ —Ç–æ–ø 5% –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                </div>
            </div>
        </div>
    </div>`;
}

function renderNavigation() {
    const tabs = [
        { id: 'home', icon: 'home', label: '–ì–ª–∞–≤–Ω–∞—è' },
        { id: 'challenges', icon: 'target', label: '–¶–µ–ª–∏' },
        { id: 'tasks', icon: 'check', label: '–ó–∞–¥–∞—á–∏' },
        { id: 'shop', icon: 'shop', label: '–®–æ–ø' },
        { id: 'analysis', icon: 'chart', label: '–ê–Ω–∞–ª–∏–∑' }
    ];

    return `
    <div class="bottom-nav">
        ${tabs.map(tab => `
            <button class="nav-item ${state.activeTab === tab.id ? 'active' : ''}" 
                onclick="state.activeTab='${tab.id}';render()">
                <div class="nav-icon">${getIcon(tab.icon)}</div>
                <div class="nav-label" style="font-size:10px;margin-top:4px">${tab.label}</div>
            </button>
        `).join('')}
    </div>`;
}

function render() {
    const app = document.getElementById('app');
    
    let contentHtml = '';
    switch(state.activeTab) {
        case 'home': contentHtml = renderHome(); break;
        case 'challenges': contentHtml = renderChallenges(); break;
        case 'tasks': contentHtml = renderTasksPage(); break;
        case 'shop': contentHtml = renderShop(); break;
        case 'analysis': contentHtml = renderAnalysis(); break;
    }

    app.innerHTML = `
        ${renderHeader()}
        <div class="content">
            ${contentHtml}
        </div>
        ${renderNavigation()}
    `;
}

// --- INIT ---
window.onload = () => {
    render();
    setTimeout(() => {
        document.getElementById('loadingScreen').classList.add('fade-out');
        setTimeout(() => document.getElementById('loadingScreen').remove(), 500);
    }, 800);
};

</script>
</body>
</html>
